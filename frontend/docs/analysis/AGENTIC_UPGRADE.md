# Agentic System Upgrade Plan

## 1. Overall Goal
Transition from the current multi-agent handoff system to a more robust and scalable agentic architecture centered around a primary orchestrator (`Basic Agent`) that utilizes specialized sub-agents as tools.

## 2. Code Consolidation & Central Orchestrator
-   **Deprecate Existing Agents:** The `simple-agent.js` and `super-simple-agent.js` files (and their respective orchestrators like `simple-orchestrator.js`, `super-simple-orchestrator.js`) will be phased out and removed.
-   **Elevate `Basic Agent`:** The `basic-agent.js` will become the sole entry point and primary orchestrator for handling user requests. It will manage the entire lifecycle of a task from initiation to completion.
-   **Corresponding Orchestrator:** `basic_orchestrator.js` will be the server-side handler for `Basic Agent`.

## 3. Agents-as-Tools Paradigm
The `Basic Agent` will not hand off control to other top-level agents. Instead, it will invoke other specialized agents as if they were tools to perform specific functions.

### 3.1. Sub-Agents:
-   **Planner Agent:**
    -   **Responsibility:** Takes a high-level task description from the `Basic Agent` and breaks it down into a structured, actionable plan.
    -   **Core Tooling:** Will utilize the `@pranavchavda/todo-mcp-server` (via an MCP connection) to create, manage, and store this plan as a list of to-do items.
-   **Executor Agent(s):**
    -   **Responsibility:** Executes individual, well-defined tasks provided by the `Basic Agent` (likely items from the plan generated by the `Planner Agent`).
    -   **Core Tooling:** Will be equipped with necessary tools for their specific domain (e.g., Shopify tools for Shopify-related tasks, file system tools for local operations, etc.).
    -   **Scalability:** The system can be expanded by adding more specialized `Executor Agents` for different types of tasks in the future.

## 4. Task Execution Flow
1.  **User Request:** User submits a task to the `Basic Agent` via the UI.
2.  **Delegation to Planner:** `Basic Agent` understands the user's intent and delegates the planning phase to the `Planner Agent`.
3.  **Plan Creation:**
    -   `Planner Agent` interacts with the `@pranavchavda/todo-mcp-server`.
    -   It creates a series of to-do items representing the steps required to accomplish the user's task.
    -   This list of to-do items *is* the plan.
4.  **Plan Presentation:** The `Planner Agent` returns the structured plan (list of to-do items) to the `Basic Agent`. The `Basic Agent` (via `basic_orchestrator.js`) then sends this plan to the UI to be displayed to the user.
5.  **Plan Management & Execution Orchestration (by `Basic Agent`):**
    -   The `Basic Agent` is responsible for managing the lifecycle of the plan.
    -   It tracks the status of each to-do item (e.g., pending, in-progress, completed) by interacting with the `@pranavchavda/todo-mcp-server`.
    -   It may update the plan (add, edit, remove tasks) based on execution progress or further user clarification.
    -   It sequentially (or in parallel, if appropriate) assigns individual tasks from the plan to the relevant `Executor Agent(s)`, providing them with the necessary context.
6.  **Task Execution (by `Executor Agent`):**
    -   The `Executor Agent` performs its assigned task.
    -   It reports its progress, results, or any issues back to the `Basic Agent`.
7.  **Completion & User Notification:**
    -   The `Basic Agent` continues this process until all tasks in the plan (managed by the `todo-mcp-server`) are marked as completed.
    -   Only once the entire initial user request is fulfilled (i.e., all to-dos are done) does the `Basic Agent` hand the turn back to the user, typically with a final summary or result.

## 5. Role of `@pranavchavda/todo-mcp-server`
-   **Persistent Plan Storage:** Acts as the database for the plan, storing all to-do items, their details, and their statuses.
-   **Single Source of Truth:** Provides a centralized and persistent view of the task's structure and progress.
-   **Agent Interaction Point:** Both the `Planner Agent` (for creating/defining the plan) and the `Basic Agent` (for managing and tracking the plan) will interact with this MCP server.

## 6. Immediate Next Steps (To-Do for Tomorrow)
1.  **Integrate `todo-mcp-server`:**
    -   In `basic-agent.js` (or a new module for the `Planner Agent` if created separately), configure a new `MCPServerStdio` instance to run `@pranavchavda/todo-mcp-server`.
    -   Command: `npx -y @pranavchavda/todo-mcp-server`.
    -   Ensure necessary environment variables (if any are specifically required by this server beyond what `MCPServerStdio` handles) are passed.
2.  **Establish Connection:**
    -   Ensure `await todoMCPServer.connect();` (or equivalent for the new instance) is called *before* the agent instance that will use it is fully initialized or attempts to list/call its tools.
3.  **Provide to Agent:** Pass the configured and connected `todoMCPServer` instance to the `mcpServers` array of the agent that will be responsible for planning (initially, this might be the `Basic Agent` itself, or a dedicated `Planner Agent` tool).
4.  **Initial Test:** Implement a basic interaction where the `Basic Agent`, upon receiving a simple task, can use the `todo-mcp-server` to create a placeholder to-do item.

## 7. Future Considerations
-   Defining the exact structure and communication protocol between `Basic Agent` and its sub-agents (Planner, Executor).
-   Error handling and retry mechanisms within the execution flow.
-   UI updates to reflect the plan and its progress dynamically.
-   Mechanisms for user interaction with the plan (e.g., approving steps, providing more info).
